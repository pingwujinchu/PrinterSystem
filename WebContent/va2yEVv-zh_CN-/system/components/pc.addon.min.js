/*! 
* WeX5 v3 (http://www.justep.com) 
* Copyright 2015 Justep, Inc.
* Licensed under Apache License, Version 2.0 (http://www.apache.org/licenses/LICENSE-2.0) 
*/

/*! 
* BeX5 v3 (http://www.justep.com) 
* Copyright 2015 Justep, Inc.
*/

define("$model/UI2/system/components/justep/smartContainer/smartContainer.config",["require"],function(e){return{properties:{},events:[],binds:{}}}),define("$model/UI2/system/components/justep/smartContainer/smartContainer",["require","$UI/system/lib/base/component","$UI/system/lib/base/string","$UI/system/lib/base/viewComponent","./smartContainer.config","css!./css/smartContainer"],function(e){var t=e("$UI/system/lib/base/component"),n=e("$UI/system/lib/base/string"),r=e("$UI/system/lib/base/viewComponent"),i=e.normalizeName("./smartContainer"),s=e("./smartContainer.config");e("css!./css/smartContainer").load();var o=r.extend({getUrl:function(){return i},constructor:function(e){this.callParent(e)},buildTemplate:function(e){return n.format("<div class='x-smartcontainer' xid='{0}' componet='{1}'></div>",e.xid)},getConfig:function(){return s},init:function(){function i(){var n=r.$el.scrollLeft();e&&n>0?(n-=r.step,r.$el.scrollLeft(n)):t&&n<r.$el.outerWidth()&&(n+=r.step,r.$el.scrollLeft(n))}this.controlWidth=50,this.step=2,this.callParent(),this.$el=$(this.domNode);var e,t,n,r=this;this.$el.mousemove(function(n){var i=n.pageX-$(this).parent().offset().left;e=i<=r.controlWidth,t=i>r.$el.outerWidth()-r.controlWidth}),this.$el.mouseover(function(e){n=setInterval(i,10)}),this.$el.mouseout(function(r){e=t=!1,clearInterval(n)})}});return t.register(i,o),o}),define("$model/UI2/system/components/justep/widgets/column.config",["require"],function(e){return{properties:{},events:[],binds:{}}}),define("$model/UI2/system/components/justep/widgets/column",["require","$UI/system/lib/base/component","$UI/system/lib/base/string","$UI/system/lib/base/viewComponent","./column.config"],function(e){var t=e("$UI/system/lib/base/component"),n=e("$UI/system/lib/base/string"),r=e("$UI/system/lib/base/viewComponent"),i=e.normalizeName("./column"),s=e("./column.config"),o=r.extend({constructor:function(e){this.callParent(e)},init:function(e,n){this.owner=t.getComponent(this.$domNode.parent().get(0)),this.callParent(e,n)},getConfig:function(){return s},dispose:function(){this.owner=null}});return t.register(i,o),o}),define("$model/UI2/system/components/justep/widgets/widget.config",["require"],function(e){return{properties:{title:"string",url:"string",process:"string",activity:"string"},events:[],binds:{}}}),define("$model/UI2/system/components/justep/widgets/widget",["require","$UI/system/lib/base/component","$UI/system/lib/base/string","$UI/system/lib/base/viewComponent","./widget.config","$UI/system/components/justep/windowContainer/windowContainer"],function(e){var t=e("$UI/system/lib/base/component"),n=e("$UI/system/lib/base/string"),r=e("$UI/system/lib/base/viewComponent"),i=e.normalizeName("./widget"),s=e("./widget.config"),o=e("$UI/system/components/justep/windowContainer/windowContainer"),u=/^(http|https):/,a=r.extend({constructor:function(e){this.title="",this.url="",this.process="",this.activity="",this.callParent(e)},buildTemplate:function(e){e.xid=e.xid||"",e.title=e.title||"";var t=n.format('<div component="$model/UI2/system/components/justep/widgets/widget" class="x-widget ibox"url="{1}" style="{2}"><div class="ibox-title"><h5>{0}</h5><div class="ibox-tools"><a component="$UI/system/components/justep/button/button" class="btn btn-link x-widget-more" label="更多"><i xid="i4"/><span xid="span1">更多</span></a><a component="$UI/system/components/justep/button/button" class="btn btn-link x-widget-toggle" label="" icon="icon-chevron-up"><i xid="i1" class="icon-chevron-up"/><span xid="span1"/></a><a component="$UI/system/components/justep/button/button" class="btn btn-link x-widget-refresh" label="" icon="icon-refresh"><i xid="i2" class="icon-refresh"/><span xid="span1"/></a><a component="$UI/system/components/justep/button/button" class="btn btn-link x-widget-close" label="" icon="icon-close"><i xid="i3" class="icon-close"/><span xid="span1"/></a></div></div><div class="ibox-content"/></div>',e.title,e.url,e.illegal&&"display: none;");return this.url=e.url,this.process=e.process,this.activity=e.activity,this.owner=e.owner,this.xid=e.xid,this.widgetID=e.id,this.height=e.height,e.refreshable?this.refreshable=e.refreshable===!0||e.refreshable.toLowerCase()==="true":e.refreshable==undefined?this.refreshable=!0:this.refreshable=!1,this.more=e.more,t},init:function(t,n){this.$el=$(this.domNode),this.widgetID&&this.$el.attr({widgetID:this.widgetID}),this.$title=$(">.ibox-title>h5",this.domNode),this.$content=$(">.ibox-content",this.domNode),this.$toggle=$(">.ibox-title .x-widget-toggle",this.domNode),this.$refresh=$(">.ibox-title .x-widget-refresh",this.domNode),this.$close=$(">.ibox-title .x-widget-close",this.domNode),this.$more=$(">.ibox-title .x-widget-more",this.domNode),this.callParent(t,n);var r=this;this.height&&this.$content.height(this.height),justep.Bind.utils.domNodeReady.addReadyCallback(this.domNode,function(){function e(e,t,n){var i=e.get(0);if(i){var s=r.getModel().comp(i);s&&s.on(t,n)}}e(r.$toggle,"onClick",function(){})}),this.$close.on("click",function(){r.owner.removeWidget(r)}),this.$toggle.on("click",function(){r.toggle()}),this.url&&(this.load(),this.refreshable?this.$refresh.on("click",function(){r.refreshable&&r.refresh()}):this.$refresh.hide()),this.more&&this.more.url?this.$more.on("click",function(){var t=e.toUrl("$model"+r.more.url);justep.Portal.openWindow(t,r.more)}):this.$more.hide()},getConfig:function(){return s},setTitle:function(e){this.$title.html(e)},propertyChangedHandler:function(e,t,n){switch(e){case"title":this.setTitle(n);break;default:this.callParent(e,t,n)}},load:function(t){var n=this;if(u.test(this.url))this.$content.addClass("frame"),this.$content.html('<iframe src="'+this.url+'"/>'),this.$frame=$(">iframe",this.$content);else var r=this.compose=new o({parentNode:this.$content.get(0),src:e.toUrl("$model"+this.url),process:this.process,activity:this.activity,onLoad:function(){t&&t(),n.on("onActive",function(){r.getInnerModel()&&r.getInnerModel().fireEvent("onActive")})},onLoadError:function(e){t&&t(e)}})},refresh:function(){this.compose?this.compose.refresh():this.$frame},toggle:function(){var e=$(">i",this.$toggle);e.hasClass("icon-chevron-up")?e.removeClass("icon-chevron-up").addClass("icon-chevron-down"):e.removeClass("icon-chevron-down").addClass("icon-chevron-up"),this.$content.toggle()},dispose:function(){this.owner=null}});return t.register(i,a),a}),define("$model/UI2/system/components/justep/widgets/widgets.config",["require"],function(e){return{properties:{columns:"number"},events:[],binds:{}}}),define("$model/UI2/system/components/justep/widgets/widgets",["require","$UI/system/lib/jquery/transition","$UI/system/components/justep/common/res","$UI/system/lib/base/component","$UI/system/lib/base/object","$UI/system/lib/justep","$UI/system/lib/base/string","$UI/system/lib/base/viewComponent","jquery","./widgets.config","$UI/system/components/justep/windowContainer/windowContainer","./widget","./js/jquery-ui-1.10.4.min","css!./css/widgets"],function(e){e("$UI/system/lib/jquery/transition"),e("$UI/system/components/justep/common/res");var t=e("$UI/system/lib/base/component"),n=e("$UI/system/lib/base/object"),r=e("$UI/system/lib/justep"),i=e("$UI/system/lib/base/string"),s=e("$UI/system/lib/base/viewComponent"),o=e("jquery"),u=e.normalizeName("./widgets"),a=e("./widgets.config"),f=e("$UI/system/components/justep/windowContainer/windowContainer"),l=e("./widget");e("./js/jquery-ui-1.10.4.min"),e("css!./css/widgets").load();var c=s.extend({constructor:function(e){this.baseCls="x-widgets",this.columns=3,this.draggable=!0,this.callParent(e)},getConfig:function(){return a},buildTemplate:function(e){return"<div></div>"},init:function(e,t){this.callParent(e,t),this.$el=o(this.domNode),this.$column=o(">.x-column",this.$el),this.$widget=o(">.x-column>.x-widget",this.$el);var n=this.getModel(),i=[],s=[];this.$widget.each(function(){i.push(o(this).attr("xid"))}),r.Array.each(i,function(e){s.push(n.componentPromise(e))}),o.when.apply(o,s).done(function(){}),this._draggable();return},load:function(e){var t,n;for(var r=1;r<=6;r++){t="column"+r,$column=o(">[xid="+t+"]",this.domNode);if(e&&e[t]){var i=e[t];$column.attr("class",i.cls).attr("classData",i.cls);if(i.widgets)for(var s=0;s<i.widgets.length;s++){var u=i.widgets[s];u.owner=this,u.parentNode=$column.get(0),new l(u)}}else $column.attr("class","x-column hidden"),$column.attr("classData","x-column hidden")}this._draggable()},getWidgetConfig:function(){var e={};return o(">.x-column",this.$el).each(function(t){var n=o(this).attr("xid"),r=[];o(">.x-widget",this).each(function(){var e=o(this).attr("widgetID");e&&r.push(e)}),e[n]={cls:o(this).attr("classData"),widgets:r}}),e},propertyChangedHandler:function(e,t,n){switch(e){default:this.callParent(e,t,n)}},activeAll:function(){var e=this;o("[component='$model/UI2/system/components/justep/windowContainer/windowContainer']",this.domNode).each(function(){var e=r.Component.getComponent(this);e&&e.getInnerModel().fireEvent("onActive")})},openWidget:function(e){var t=o('>[xid="column1"]',this.domNode);e.owner=this,e.parentNode=t.get(0),new l(e),this.fireEvent("change",{source:this}),this._draggable()},removeWidget:function(e){if(typeof e=="string")var n=o('.x-widget[widgetid="'+e+'"]',this.domNode).get(0);n?(t.removeNode(n),this.fireEvent("change",{source:this})):(t.removeComponent(e),this.fireEvent("change",{source:this}))},hasWidget:function(e){return o('.x-widget[widgetid="'+e+'"]',this.domNode).length>0},setLayout:function(e){var t,n;for(var r=1;r<=6;r++){var i="column"+r;t=o(">[xid="+i+"]",this.domNode);if(e&&e[i]){var s=e[i];t.attr("class",s.cls).attr("classData",s.cls),t&&t.length>0&&(n=t)}else t.attr("class","x-column hidden"),t.attr("classData","x-column hidden"),n&&o(">.x-widget",t).appendTo(n)}},_draggable:function(){if(this.draggable){var e=o(">.x-column >.x-widget",this.domNode),t=o(this.domNode),n=this;this._inited&&o(">.x-column",this.domNode).sortable("destroy"),this._inited=!0,o(">.x-column",this.domNode).sortable({items:e,connectWith:o(">.x-column",this.domNode),handle:".ibox-title",placeholder:"widget-placeholder",forcePlaceholderSize:!0,revert:300,delay:100,opacity:.8,start:function(e,n){t.addClass("dragging")},stop:function(e,r){t.removeClass("dragging"),n.fireEvent("move",{source:n,item:r.item.get(0)}),n.fireEvent("change",{source:n})}})}}});return r.Component.addOperations(c,{}),t.register(u,c),c}),define("$model/UI2/system/components/justep/cellLayout/cellLayout",["require","$UI/system/components/justep/common/res","$UI/system/lib/justep","css!./css/cellLayout"],function(e){e("$UI/system/components/justep/common/res");var t=e("$UI/system/lib/justep"),n=e.normalizeName("./cellLayout");e("css!./css/cellLayout").load();var r=t.BindComponent.extend({constructor:function(e){this.callParent(e)},dispose:function(){this.callParent()},doInit:function(e,t){},render:function(){},propertyChangedHandler:function(e,t,n){switch(e){case"rowheight":break;case"columnwidth":break;default:this.callParent(e,t,n)}}});return t.Component.register(n,r),r}),define("$model/UI2/system/components/justep/excelLayout/excelLayout",["require","$UI/system/components/justep/common/res","$UI/system/lib/justep","jquery"],function(e){e("$UI/system/components/justep/common/res");var t=e("$UI/system/lib/justep"),n=e.normalizeName("./excelLayout"),r=e("jquery"),i=t.BindComponent.extend({constructor:function(e){this.callParent(e)},dispose:function(){this.callParent()},showLine:function(){r(this.domNode).addClass("x-excel-layout")},hideLine:function(){r(this.domNode).removeClass("x-excel-layout")}});return t.Component.register(n,i),i}),define("$model/UI2/system/components/justep/absoluteLayout/absoluteLayout",["require","$UI/system/components/justep/common/res","$UI/system/lib/justep","css!./css/absoluteLayout"],function(e){e("$UI/system/components/justep/common/res");var t=e("$UI/system/lib/justep"),n=e.normalizeName("./absoluteLayout");e("css!./css/absoluteLayout").load();var r=t.BindComponent.extend({constructor:function(e){this.callParent(e)},dispose:function(){this.callParent()},doInit:function(e,t){},render:function(){},propertyChangedHandler:function(e,t,n){switch(e){case"rowheight":break;case"columnwidth":break;default:this.callParent(e,t,n)}}});return t.Component.register(n,r),r}),define("$model/UI2/system/components/justep/pagerBar/pagerBar.config",["require"],function(e){return{properties:{data:"string"},events:[],binds:{}}}),define("$model/UI2/system/components/justep/pagerBar/pagerBar",["require","$UI/system/lib/base/component","$UI/system/lib/base/string","$UI/system/lib/base/viewComponent","./pagerBar.config","$UI/system/components/justep/data/data","css!./css/pagerBar"],function(e){var t=e("$UI/system/lib/base/component"),n=e("$UI/system/lib/base/string"),r=e("$UI/system/lib/base/viewComponent"),i=e.normalizeName("./pagerBar"),s=e("./pagerBar.config"),o=e("$UI/system/components/justep/data/data");e("css!./css/pagerBar").load();var u=r.extend({getUrl:function(){return i},label:"当前显示{0}-{1}条，共{2}条",constructor:function(e){this.data=null,this.callParent(e)},buildTemplate:function(e){return n.format("<div class='x-pagerbar' xid='{0}' componet='{1}'></div>",e.xid)},getConfig:function(){return s},init:function(){this.callParent(),this.$el=$(this.domNode),this.setLabel();var e=this;this.data&&(this.bindData=this.getModel().comp(e.data),this.bindData.on(o.EVENT_DATA_CHANGE,function(t){var n=e.bindData.limit,r=e.bindData.getTotal(),i=e.bindData.getOffset();e.setLabel(i-n,n,r)}))},setLabel:function(e,t,r){var i=this.emptyLabel||"";r!==undefined&&r!==0&&(i=n.format(this.label,e+1,Math.min(e+t,r),r)),$(".x-pagerbar-info",this.$el).html(i)}});return t.register(i,u),u}),define("$model/UI2/system/components/justep/pagerLimitSelect/pagerLimitSelect.config",["require"],function(e){return{properties:{hasLabel:"boolean",defaultValue:"number",data:"string"}}}),define("$model/UI2/system/components/justep/pagerLimitSelect/pagerLimitSelect",["require","$UI/system/lib/justep","css!./css/pagerLimitSelect","./pagerLimitSelect.config","$UI/system/components/justep/select/select"],function(e){var t=e("$UI/system/lib/justep");e("css!./css/pagerLimitSelect").load();var n=e.normalizeName("./pagerLimitSelect"),r=e("./pagerLimitSelect.config"),i=e("$UI/system/components/justep/select/select"),s=t.BindComponent.extend({getConfig:function(){return r},constructor:function(e){this.data=null,this.defaultValue=20,this.hasLabel=!0,this.callParent(e)},init:function(e,t){this.callParent(e,t);var n=this;this.$el=$(this.domNode);var r=$(">select",this.$el).attr("xid");this.getModel().componentPromise(r).done(function(e){n.select=e,n.select.val(n.defaultValue);if(n.data){var t=n.getModel().comp(n.data);t.limit=parseInt(n.select.val())}n.select.on("onChange",function(e){if(n.data){var t=n.getModel().comp(n.data),r=parseInt(e.value);t.limit=r,t.refreshData({async:!0})}})}),this.hasLabel&&this.$el.addClass("hasLabel")},buildTemplate:function(e){return""},propertyChangedHandler:function(e,t,n){var r=$(this.domNode);switch(e){case"hasLabel":n=="true"||n==1?(r.addClass("hasLabel"),this.hasLabel=!0):(r.removeClass("hasLabel"),this.hasLabel=!1);break;case"defaultValue":this.defaultValue=parseInt(n)}},dispose:function(){this.callParent()}});return t.Component.register(n,s),s});